<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ExcelJS Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <button id="downloadBtn">Download Excel</button>
    <script>
        // Inisialisasi workbook dan worksheet
        const workbook = new ExcelJS.Workbook();
        const worksheet = workbook.addWorksheet('Sheet 1');

        // Mengisi baris pertama (baris 10)
        worksheet.getRow(10).values = [
            'No',
            'Nama Marketplace',
            'Tahun n-1',
            'Tahun n-2',
            'Tahun n',
            '',
            '',
            '',
            'Keterangan'
        ];

        // Mengisi baris kedua (baris 11)
        worksheet.getRow(11).values = [
            '',
            '',
            '',
            '',
            'Triwuan 1',
            'Triwuan 2',
            'Triwuan 3',
            'Triwuan 4',
            ''
        ];

        // Menggabungkan sel (contoh)
        worksheet.mergeCells('A10:A11'); // Menggabungkan A10 dan A11
        worksheet.mergeCells('B10:B11'); // Menggabungkan B10 dan B11
        worksheet.mergeCells('C10:C11'); // Menggabungkan C10 dan C11

        // Mengisi teks pada sel pertama setelah penggabungan
        worksheet.getCell('A10').value = 'No';  // Ini akan terlihat di sel A10 dan A11 karena mereka digabung
        worksheet.getCell('B10').value = 'Marketplace';  // Ini akan terlihat di B10 dan B11
        worksheet.getCell('C10').value = 'Year n';  // Ini akan terlihat di C10 dan C11

        // Menambahkan style header untuk baris 10
        const headerRow = worksheet.getRow(10);
        headerRow.font = { bold: true };  // Mengatur font header menjadi tebal
        headerRow.alignment = { horizontal: 'center' };  // Mengatur rata tengah

        // Fungsi untuk mendownload file
        document.getElementById('downloadBtn').addEventListener('click', function () {
            workbook.xlsx.writeBuffer().then(function (buffer) {
                const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                saveAs(blob, 'example.xlsx');
            });
        });
    </script>
</body>
</html>
